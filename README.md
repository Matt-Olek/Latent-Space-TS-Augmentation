# Latent Space TS Augmentation
 
 This repository aims at implementing a simple and efficient method to augment time series data using a latent space. The method is based on the idea of using a variational autoencoder (VAE) to learn a latent space representation of the time series data. The latent space is then used to generate new time series data by sampling from the latent space.

 The method is implemented using :
    - [Python 3.12.3](https://www.python.org/)
    - [PyTorch](https://pytorch.org/)
    - [NumPy](https://numpy.org/)
    - [Pandas](https://pandas.pydata.org/)

## Installation
All required packages are listed in the `requirements.txt` file. You can install them using the following command:
```bash
pip install -r requirements.txt
```

## Usage

This augmentation method leverages a VAE alongside a classification model (ResNet). The VAE, trained on the original time series data, learns a latent space representation. New time series data is generated by adding noise to true latent space points and assigning them the original labels. This augmented data trains the classification model. We compare a baseline approach, where the model is trained on original data, to an augmented approach, where the model is trained on original plus generated data.

The datasets used in this repository are from the [UCR Time Series Classification Archive](https://www.cs.ucr.edu/~eamonn/time_series_data_2018/). They are stored in the `data` folder and loaded using the custom 'loader.py' script. Feel free to add your **own** datasets to the `data` folder and load them using and adapted version of the 'loader.py' script.

To run the code, you can use the following command:
```bash
python LSTSAUG/main.py
```

The following arguments can be used:

> Dataset and Directories :
- **--data_dir** : Directory containing the dataset *(str, default: '../../- FastAutoAugment-Time-Series/data')*
- **--dataset** : Name of the dataset *(str, default: 'Symbols')*
- **--model_dir** : Directory to save models *(str, default: 'models')*
- **--results_dir** : Directory to save results *(str, default: 'results')*

> Training Parameters :
- **--num_epochs** : Number of epochs to train the model *(int, default: 400)*
- **--batch_size** : Batch size for training *(int, default: 64)*
- **--learning_rate** : Learning rate for training *(float, default: 0.001)*
- **--seed** : Random seed for reproducibility *(int, default: 42)*

> Latent Space Augmentation :
- **--latent_dim** : Dimension of the latent space *(int, default: 64)*
- **--noise** : Noise level for the latent space perturbation *(float, default: 0.1)*
- **--num_samples** : Number of synthetic data samples to generate for each input sample *(int, default: 1)*

> Augmentation and Comparison :

⚠️ Without Augmentation and Comparison arguments, the code will simply train the VAE but not use it
- **--baseline** : Train a baseline classifier *(store_true, default: False)*
- **--test_augment** : Test the augmentation using the trained VAE *(store_true, default: False)*
- **--use_trained** : Use a previously trained VAE for augmentation *(store_true, default: False)*
- **--augment_plot** : Augment the dataset using the trained VAE *(store_true, default: False)*

> Weights and Biases :
- **--wandb** : Use Weights and Biases for experiment tracking *(store_true, default: False)*

